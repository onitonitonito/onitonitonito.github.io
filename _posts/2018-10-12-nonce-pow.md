---
layout: post
title: BitCoin-Minning, What do nonce, POW mean for?ğŸ‘·
comments: true
category: [blockChain]
tag: [nonce, pow]
excerpt_separator: <!-- more -->
---

<img width="125" align="left" style="padding: 0px 10px 0px 0px;"
src="/images/post_img/20181012-00.png" >

<span id="start-ch">Once</span> you know the hash function, the most important idea of â€‹â€‹cryptocurrency, then you need to know about proof of work (POW), which is essential in the mining process. It is the proof that the miner has elaborated this much to find out target hash.

<!-- more -->


<br><br>

*  In the process of proof-of-work (POW), nonce and difficulty arise. Difficulty is a variable that makes it difficult to mine a block. This is easy to accept, but the concept of nonce is hard to grasp. Let's make assumption like this.



# Picking balls which are numbered upto 100 in a pouch

* Put 100 numbered balls into an invisible pouch, and three people A, B, and C draw each and each ball. If a number that satisfies the criteria comes out, it passes, but otherwise, put the ball into a pouch again and repeat the drawing. Here, the conditions below are applied to increase the difficulty.

<img src="/images/post_img/20181012-01.png" width="450">

* A ëŠ” `90` ë³´ë‹¤ ì‘ì€ ìˆ˜ë¥¼ ë½‘ìœ¼ë©´ í†µê³¼ (ì‘ì—…ì¦ëª…)ì„ ë°›ì•„ì¤€ë‹¤.  
* B ëŠ” `50` ë³´ë‹¤ ì‘ì€ ìˆ˜ë¥¼ ë½‘ì•„ì•¼ í†µê³¼ (ì‘ì—…ì¦ëª…)ì„ ë°›ì•„ì¤€ë‹¤.    
* C ëŠ” `5` ì´í•˜ì˜ ìˆ«ìë¥¼ ë½‘ì•˜ì„ ë•Œë§Œ í†µê³¼ì‹œì¼œ ì¤€ë‹¤.


ëˆ„ê°€ ë¹ ë¥¸ì‹œê°„ ë‚´ì— ì¡°ê±´ì„ ì¶©ì¡±í•˜ê³  ì‘ì—…ì„ ë§ˆì¹  ìˆ˜ ìˆì„ê¹Œ? ë‹¹ì—°íˆ Aê°€ ì›”ë“±íˆ ì ì€ íšŸìˆ˜ë¡œ ì‘ì—…ì„ ë§ˆì¹  ìˆ˜ ìˆë‹¤

ì˜ˆë¥¼ ë“¤ì–´,

> 1.  A ëŠ” 5ë²ˆ ë§Œì— 90ë³´ë‹¤ ì‘ì€ ìˆ˜ë¥¼ ë½‘ì•„ í†µê³¼í–ˆë‹¤.    
> 2.  B ëŠ” 13ë²ˆ ë§Œì— 50ë³´ë‹¤ ì‘ì€ ìˆ˜ë¥¼ ë½‘ì•„ í†µê³¼í–ˆë‹¤.    
> 3.  C ëŠ” 59ë²ˆ ë§Œì— 5ë³´ë‹¤ ì‘ì€ ìˆ˜ë¥¼ ë½‘ì•„ í†µê³¼í–ˆë‹¤.

í•­ìƒ C ê°€ ë” ë§Œì€ íšŸìˆ˜ë¥¼ ì‹œë„í•´ì•¼ ë˜ëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤. í•œë²ˆì— í†µê³¼í•  ìˆ˜ë„ ìˆë‹¤.  
í•˜ì§€ë§Œ, í™•ë¥ ì ìœ¼ë¡œ C ê°€ ë” ë§ì´ ê³ ìƒí•´ì•¼ í•  ê²ƒì´ë‹¤.    



<br><br>
<!-- RANDOM PICKING 10 OUT OF 100 -->
<img src="/images/post_img/20181012-03.png" width="650">



<br><br>
ì—¬ê¸°ì„œ,    

1.  `90 ë³´ë‹¤ ì‘ì€ ìˆ˜` ë¼ëŠ” `ì¡°ê±´`ì€ **ë‚œì´ë„** (`difficulty`)
2.  **ë°˜ë³µì‘ì—…** `5ë²ˆ` ì˜ íšŸìˆ˜ê°€ **ë…¼ìŠ¤**(`nonce`) ë‹¤

**nonce** ëŠ” ëª‡ ë²ˆì„ ë°˜ë³µí•´ì„œ ì‹œë„ í–ˆëŠ”ì§€, íšŸìˆ˜ì´ë©°, ì´ íšŸìˆ˜ê°€ ì–¼ë§Œí¼ ê³ ìƒí–ˆëŠ”ì§€ë¥¼ ì…ì¦í•˜ëŠ” ì‘ì—…ì¦ëª… (proof_of_work)ì´ë‹¤. ë…¼ìŠ¤ë¥¼ í¬í•¨í•´ì„œ, í˜„ì¬ì˜ Hash ê°’ì´ ê³„ì‚°ë˜ì•¼ í•˜ë©°, ìœ ì¼í•˜ê²Œ ë³€ê²½í•  ìˆ˜ ìˆëŠ” í•´ì‰¬ì…ë ¥ê°’ í†µë¡œ NONCE ë³€ê²½ ì‹œì¼œ ê°€ë©´ì„œ í•´ì‰¬ê°’ì„ ë°˜ë³µì ìœ¼ë¡œ ê³„ì‚°í•˜ë‹¤ ë³´ë©´ **ìš°ì—°í•˜ê²Œ** ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” í•´ì‰¬ê°’ì„ ì°¾ì•„ë‚¸ë‹¤. ë¹ ë¥´ê²Œ ê³„ì‚°í• ìˆ˜ ìˆëŠ” ëŠ¥ë ¥ì„ ê°€ì§„ì‚¬ëŒì—ê²Œ ê¸°íšŒê°€ ë” ë§ì§€ë§Œ, ì°¾ì„ í™•ë¥ ì€ **ìš°ì—°** ì— ê¸°ë°˜í•˜ê¸° ë•Œë¬¸ì— ì ˆëŒ€ì ì¸ ê²ƒì€ ì•„ë‹ˆë‹¤ ~~..ì´ê±°, ë‹¤ ìƒˆë¹¨ê°„ ê±°ì§“ë§ì¸ê±° ë‹¤ ì•„ì‹œì£ ? ì—¬ëŸ¬ë¶„!..~~



<br><br>
# ì•„ë˜ ë¸”ëŸ­ê²°ê³¼ë¥¼ ë¹„êµí•´ ë³´ì

ë‚œì´ë„ì— ë”°ë¼ì„œ, ê¸°ì¤€ë³´ë‹¤ ì‘ì€ í•´ì‰¬ë¥¼ ê³„ì‚°í–ˆì„ ë•Œ ì‹œë„í•œ íšŸìˆ˜, **ë…¼ìŠ¤(nonce)** ë¥¼ ë³´ì—¬ì¤€ë‹¤, ì¼ì •í¬ê¸° ì´í•˜ì˜ í•´ì‰¬ë¥¼ ë½‘ì•„ë‚´ê¸°ê°€ ì–´ë ¤ìš´ ë§Œí¼ ì‹œë„íšŸìˆ˜ ë…¼ìŠ¤ê°€ ì¦ê°€ í–ˆë‹¤.

<br><br>

{% highlight javascript linenos %}
{'difficulty': '000',
 'hash_present': '000107d0d540f0edf7eb0af657840b51',
 'hash_previous': '000005fa8482b821aff9b2ce6103f69e',
 'index': 1,
 'nonce': 7725,
 'timestamp': 1539440895.4122593,
 'transaction': [{'amount': 1000, 'recipient': 'Bob', 'sender': 'Alice'},
                 {'amount': 800, 'recipient': 'Alice', 'sender': 'Scrouge'},
                 {'amount': 200,
                  'recipient': 'node_identifier_uid',
                  'sender': 'coinbase_reward'}]}
{% endhighlight %}

-   **ì‹œë„íšŸìˆ˜(ë…¼ìŠ¤) = 7,725íšŒ**
-   ë§Œì¡±í•˜ëŠ” present_hash ê°’ì„ ì°¾ì•˜ì„ ë•Œ,
-   íƒ€ì„ìŠ¤íƒ¬í”„ë¥¼ ì°ê³ , í˜„ì¬í•´ì‰¬ê°’ì„ ì¶”ê°€í–ˆë‹¤
-   ì¦‰, íƒ€ì„ìŠ¤íƒ¬í”„ì™€ í˜„ì¬í•´ì‰¬ê°’ì„ ëº€ ë¸”ëŸ­ì„ í•´ì‰¬256 í•¨ìˆ˜ì—, ë…¼ìŠ¤ê°’ê³¼ ê°™ì´ ë„£ìœ¼ë©´
-   í˜„ì¬ì˜ ì¡°ê±´ì— ë§Œì¡±í•˜ëŠ” í•´ì‰¬ê°’ì´ ë‚˜ì˜¨ë‹¤.
-   í•´ì‰¬ ì…ë ¥ê°’ì—ì„œ ë…¼ìŠ¤ë¥¼ í¬í•¨í•œ ê·¸ ì–´ë–¤ê¸€ìê°€ í•œê¸€ìë§Œ ë°”ë€Œì–´ë„,
-   í•´ì‰¬ê°’ì€ ì¡°ê±´ì—ì„œ ë²—ì–´ë‚œë‹¤.
-   ì¦‰, íŠ¹ì • ë…¼ìŠ¤ê°’ì„ ì°¾ì•„ì•¼ë§Œ, ì¡°ê±´ì— ë§ëŠ” í•´ì‰¬ê°’ ì‘ì—…ì¦ëª…ì„ ì´ë¤„ë‚¸ë‹¤.
-   í•´ì‰¬ê°’ì€ ë¬´ì‘ìœ„ìˆ˜ì´ê¸° ë•Œë¬¸ì—, ë…¼ìŠ¤ë¥¼ 1ì”© ì¦ê°€ì‹œí‚¤ë©°, ë°˜ë³µ ê³„ì‚°í•œë‹¤
-   ì´ ê³¼ì •ì´ ëœë¤í”¼í‚¹ê³¼ ê°™ì€ ë™ì‘ì´ë‹¤.

<br><br>

{% highlight javascript linenos %}
{'difficulty': '00000',
 'hash_present': '00000da730623b47a1e4d39a4d28ccfe',
 'hash_previous': '000005fa8482b821aff9b2ce6103f69e',
 'index': 12,
 'nonce': 52305,
 'timestamp': 1539441010.7054014,
 'transaction': [{'amount': 1000, 'recipient': 'Bob', 'sender': 'Alice'},
                 {'amount': 800, 'recipient': 'Alice', 'sender': 'Scrouge'},
                 {'amount': 200,
                  'recipient': 'node_identifier_uid',
                  'sender': 'coinbase_reward'}]}
{% endhighlight %}

-   ë‚œì´ë„ê°€ ë‘ìë¦¿ìˆ˜ ì¶”ê°€ë¡œ ë–¨ì–´ì§€ë‹ˆê°€, **ì‹œë„íšŸìˆ˜ê°€ 52,305íšŒ** ë¡œ ëŠ˜ì–´ë‚¬ë‹¤.
-   ì¡°ê±´ì— ë§ëŠ” í•´ì‰¬ê°’ì„ ê³„ì‚°í• ìˆ˜ ìˆëŠ” ì…ë ¥ê°‘ ë…¼ìŠ¤ë¥¼ ì°¾ì•„ë‚´ê³ 
-   ì¡°ê±´ì— ë§ëŠ” í•´ì‰¬ê°’ì„ ì°¾ì•„ë‚´ë©´ ì‘ì—…ì¦ëª…ì´ ì´ë£¨ì–´ì§„ë‹¤.
-   ê° ë¸”ëŸ­ì˜ ì—°ê²°ê³ ë¦¬ëŠ” ì¡°ê±´ì— ë§ëŠ” í•´ì‰¬ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ì•ë’¤ë¡œ ì—°ê²°ë˜ì–´ìˆë‹¤.
-   ì¡°ê±´ì— ë§ëŠ” í•´ì‰¬ê°’ë¥¼ ì°¾ì•„ì„œ ì•/ë’¤ ë¸”ëŸ­ì„ ì ê·¼ê²ƒì´ë‹¤.
-   ê¸¸ì´ê°€ ê¸´, ì¼ë ¨ì˜ ë¸”ë¡ë“¤ì€ ì•/ë’¤ ë¬´ê²°ì„±ì„ í•´ì‰¬ê°’ìœ¼ë¡œ ì¦ëª…í•œë‹¤.
-   ëŠ˜ì–´ì„  ë¸”ëŸ­ì˜ ë‚´ìš©ì´ í•˜ë‚˜ë¼ë„ ë°”ë€ë‹¤ë©´, ë’¤ì— ë¸”ëŸ­ì€ ëª¨ë‘ ë¬´íš¨ê°€ ëœë‹¤.
-   í•´í‚¹ì„ ìœ„í•´ ì¤‘ê°„ê°’ì„ ë°”ê¾¸ë ¤ë©´, ê·¸ ì´í›„ ë¸”ëŸ­ì˜ ì‘ì—…ì¦ëª…ì„ ëª¨ë‘ ë°”ê¿”ì•¼ í•œë‹¤.
-   ì´ ê³¼ì •ì—ì„œ ì‘ì—…ì¦ëª…ì„ í•˜ëŠ”ë°, ë„ˆë¬´ ë§ì€ ì‹œê°„ì´ ì†Œìš”ëœë‹¤.

<br><br>

{% highlight javascript linenos %}
{'difficulty': '0000000',
 'hash_present': '0000000f8fc7d21dc1a4c67f3ec72ac5',
 'hash_previous': '000005fa8482b821aff9b2ce6103f69e',
 'index': 12,
 'nonce': 19760524,
 'timestamp': 1539441177.5858967,
 'transaction': [{'amount': 1000, 'recipient': 'Bob', 'sender': 'Alice'},
                 {'amount': 800, 'recipient': 'Alice', 'sender': 'Scrouge'},
                 {'amount': 200,
                  'recipient': 'node_identifier_uid',
                  'sender': 'coinbase_reward'}]}
{% endhighlight %}

-   ë‚œì´ë„ê°€ ë„¤ìë¦¬ ì¶”ê°€ë¡œ ë–¨ì–´ì ¸ì„œ, **ì‹œë„íšŸìˆ˜ê°€ 19,760,524ë²ˆ** ìœ¼ë¡œ ëŠ˜ì–´ë‚¬ë‹¤.
-   ë¸”ëŸ­ì´ ë’¤ë¡œ ê°ˆìˆ˜ë¡ ë‚œì´ë„ê°€ ì¦ê°€í•˜ë©°, ì‘ì—…ì¦ëª…ì— ì‹œê°„ì´ ê¸°í•˜ê¸‰ìˆ˜ì ìœ¼ë¡œ ëŠ˜ì–´ë‚¨.
-   ì¤‘ê°„ë¸”ëŸ­ ë‚´ìš©ì„ ìœ„ì¡°í•˜ë©´, ì´í›„ ë¸”ëŸ­ì˜ ëª¨ë“  ì‘ì—…ì¦ëª…ì„ ë°”ê¿”ì•¼ í•´í‚¹ì´ ì™„ì„±ë˜ëŠ”ë°,
-   ë¸”ëŸ­ì€ 10ë¶„ë§ˆë‹¤ ì¶”ê°€ë¡œ ìƒì„±ëœë‹¤.
-   ê²Œë‹¤ê°€, ì¼ë ¨ì˜ ë¸”ëŸ­ëª¨ìŒ ì •ë³´ëŠ” ëª¨ë“  ë…¸ë“œë“¤ì´ ìë™ìœ¼ë¡œ ê³µìœ í•˜ê³  ìˆë‹¤.
-   ë”°ë¼ì„œ, ë…¸ë“œê°„ì— ê³µìœ í•˜ê³  ìˆëŠ” ëª¨ë“  ë¸”ëŸ­ì„ ì¼ìˆœê°„ì— í•´í‚¹ í•˜ëŠ”ê²ƒì€ ë¶ˆê°€ëŠ¥ í•˜ë‹¤.



<br><br>

| <img src="/images/post_img/20181012-02.png" width="450"> |
| :----------------------------------------------------------: |
| [image ref.]: [Understanding How Blockchain Works](https://blog.ndcconferences.com/understanding-blockchain/) |

- ë¸”ëŸ­í•´ì‰¬ì˜ ì…ë ¥ ê°’ì„ ë³€ê²½ì‹œí‚¬ ìˆ˜ ìˆëŠ” ìœ ì¼í•œ ë³€ìˆ˜ëŠ” ë…¼ìŠ¤(nonce)ë‹¤.
- ë…¼ìŠ¤ë¥¼ ë³€ê²½í•˜ë©°, í•´ì‰¬ê°’ì„ ê³„ì‚°í•´ì„œ ë‚œì´ë„ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” ê°’ì´ ë‚˜ì˜¬ ë•Œ ë°˜ë³µ
- ë…¼ìŠ¤ëŠ” 0 ì—ì„œë¶€í„° +1ì”© ì¦ê°€ì‹œí‚¤ë©° ë°˜ë³µ ê³„ì‚°í•˜ê¸° ë•Œë¬¸ì— ê²°ê³¼ì ìœ¼ë¡œ ê³„ì‚° íšŸìˆ˜ë‹¤.




<br><br>
<!-- NONCE AND DIFFICULTY RESULTS OF HASH -->
# Result of the Block Hash Calculation, Changing difficulty

* ë‚œì´ë„ë¥¼ ë°”ê¿”ì„œ ê³„ì‚°í•´ ë³´ë©´, ê³„ì‚°ì‹œê°„ê³¼ ë°˜ë³µíšŸìˆ˜ì—ì„œ í° ì°¨ì´ê°€ ë‚œë‹¤.
* Previous hash is '0000...' pressent hash starts with '000000...'

| <a alt="to see bigger size" target="new" href="/images/post_img/20181012-04.png" ><img src="/images/post_img/20181012-04.png"></a> |
| :----------------------------------------------------------: |
| ğŸ˜¢ difficulty related with nonce makes different on execute time. (click to see bigger) |



<br><br>
# ğŸ¥Well-explained VOD about what does nonce mean for.

-   ë…¼ìŠ¤(nonce)ì™€ ì‘ì—…ì¦ëª…(POW)ì— ëŒ€í•´ì„œ ì•„ì£¼ ì˜ ì„¤ëª… í•´ ë†“ì€ ì˜ìƒ

<iframe width="560" height="315" src="https://www.youtube.com/embed/_160oMzblY8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>

ë”°ë¼í•˜ê¸°ë„ ê°€ëŠ¥~

* YouTube Here : [https://www.youtube.com/watch](https://bit.ly/2WYw2kf)
* Code Here : [https://github.com/anders94/blockchain-demo](https://bit.ly/337RJ5x)


<br><br>
# CODE REVIEW

ë‚œì´ë„(difficulty)ë¥¼ ë°”ê¿”ê°€ë©´ì„œ, ë…¼ìŠ¤(nonce)ë¥¼ ë³€ê²½ í•´ì„œ ê³„ì‚° í•´ ë³´ì.  

* ë¸”ë¡ ì•ˆì— ëª¨ë“  ê°’ ë“¤ì€ ì´ë¯¸ ê²°ì • ë˜ì–´ ìˆë‹¤ (present hash = 0000 ....)
* nonce ë§Œì´ ìœ ì¼í•˜ê²Œ minner ê°€ ë°”ê¿€ ìˆ˜ ìˆëŠ” ê°’ ì´ë‹¤.
* ëª©í‘œ Present hash ë¥¼ ì°¾ê¸° ìœ„í•´ nonceë¥¼ 1ì”© ì¦ê°€ ì‹œí‚¤ë©° Try & Errorë¡œ ì°¾ëŠ”ë‹¤.
* ìš°ì—°íˆ í•´ì‰¬ê°’ì˜ ì²«ìë¦¬ê°€ '0000'ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ëª©í‘œ í•´ì‰¬ë¥¼ ë°œê²¬ í–ˆì„ ë•Œ,
* ì‘ì—… ì¦ëª…ì„ ì™„ì„± í•œë‹¤. ì‘ì—…ì¦ëª…(Proof of Work) ê°’ì€ nonce=7725 ì´ë‹¤.

{% highlight python linenos %}
import time
import pyprnt
from hashlib import sha256

# difficulty ë¥¼ '0000' ì—ì„œ 0 ì„ í•˜ë‚˜ì”© ëŠ˜ë ¤ ì‹¤í–‰ì‹œê°„ì„ ë¹„êµí•œë‹¤.
difficulty = '0000'

mining_uid = 'node_identifier_uid'
transactions = [
    {
        'sender': 'Alice',
        'recipient': 'Bob',
        'amount': 1000
    },
    {
        'sender': 'Scrouge',
        'recipient': 'Alice',
        'amount': 800
    },
    {
        'sender': 'coinbase_reward',
        'recipient': mining_uid,
        'amount': 200
    },
]


last_block = {
    'index': 12,
    'difficulty': difficulty,
    'nonce': 0,
    'hash_previous': '000005fa8482b821aff9b2ce6103f69e',
    'transaction': transactions,
}


def get_hash_w_nonce(last_block, nonce):
    """ ìµœê·¼ë¸”ëŸ­ì— ë…¼ìŠ¤ë¥¼ ëŒ€ì…í•˜ì—¬ í•´ì‰¬ê°’ì„ ë¦¬í„´í•œë‹¤"""
    last_block['nonce'] = nonce
    hash = sha256(str(last_block).encode()).hexdigest()
    return hash

def add_header(last_block, block_hash):
    """ ë¸”ëŸ­ì— íƒ€ì„ìŠ¤íƒ¬í”„ì™€ í˜„ì¬í•´ì‰¬ë¥¼ ì¶”ê°€í•œë‹¤"""
    header = {
        'timestamp': time.time(),
        'hash_present': block_hash, }

    for _key, _val in header.items():
        last_block[_key] = _val

    return last_block

def proof_of_work(last_block):
    nonce = 0
    difficulty = last_block['difficulty']

    while True:
        hash = get_hash_w_nonce(last_block, nonce)

        if hash[:len(difficulty)] == difficulty:
            hash_present = hash[:32]
            add_header(last_block, hash_present)
            return last_block

        nonce += 1

if __name__ == '__main__':
    last_block = proof_of_work(last_block)
    pyprnt.prnt(last_block)
{% endhighlight %}

<!-- <script src="https://gist.github.com/onitonitonito/dad3bac1b897fba1122a36cd97244621.js"></script> -->
