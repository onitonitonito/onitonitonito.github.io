---
layout: post
title: 웹스크랩핑-공기질 데이터를 분석하기 (아름다운수프)😸
comments: true
category: [Webscrapping]
tag: [bs4, beautifulsoup]
excerpt_separator: <!-- more -->
---
<img alt="사스가한국" src="/images/post_img/20180927-00.png" width="140" align="left" style="padding: 0px 30px 0px 10px;">

beautifulsoup 를 사용하여, 대기환경 연구소에서 웹으로 제공하는 실시간 공기질 측정 데이터값을 불러와 Pandas로 변형하고 matplotlib로 분석해 봅니다. 제공받는 측정데이터는 PM2.5 PM10 미세먼지를 포함, 아황산가스(SO2), 이산화질소(NHO2), 오존(O3)과 이산화탄소(CO2), AKA 이산화가스,가 있습니다.
<!-- more -->

<br><br>

# 제 9장 모조 거북 이야기
> 공작부인은 들어서며 앨리스에게 다정한 척 치근댄다. 공작부인이 어떤 이야기든 교훈을 늘어 놓자 앨리스는 지루해 한다. 이 때 하트 여왕이 나타나고 공작부인은 도망간다. 하트 여왕은 앨리스에게 그리폰을 타고 모조 거북을 만나러 가라고 명령한다.


## 그리폰이 물었다.

>"노래를 듣고 싶어. 가짜 거북이가 불어준다면 말이야."
>앨리스는 너무나 간절한 말투로 부탁하자, 그리폰은 조금 기분이 나빠진 듯 했다.

<img alt="아름다운수프" src="/images/post_img/20180927-0.png" width="250" align="left" style="padding: 0px 30px 0px 0px;">

>"흥! 취향도 별나군! 이봐, 친구, 이 애한테 [**거북이 수프**] 를 불러주겠어?"
>가짜 거북은 깊은 한숨을 쉰 후, 흐느껴서 잠긴 목소리로 노래를 부르기 시작했다.
>
> "✨**아름다운수프**✨, 기름진 초록빛 수프가"
뜨거운 수프 그릇에서 기다리고 있다네.
저렇게 맛있는 음식을 누가 거절 할 수 있으랴?
>
>저녁의 수프, 아름다운 수프!
아르 - 름다운 수우우-프!
아르 - 름다운 수우우-프!



<br><br>
# 1.0 환경정보 공개시스템

인천광역시 보건환경연구원 웹사이트에 들어가면 2일간의 실시간 공기질 측정데이터를 공개하고 있습니다. 인천에는 약 7~8군데의 측정소 실시간 데이터를 제공하는데, 관심지역을 조회해 보시면 좋을것 같습니다.

>
| <img src="/images/post_img/20180927-04songdo.png" width="600"> |
|:----------------------------------------------|
| [[보건환경연구원]](https://goo.gl/AuTGRf) 송도지역 공기질 측정데이터 |


**'아름다운수프'** 는 대표적인 Python 웹스크래핑 라이브러리인데, 위에 잠시 소개한, **'이상한 나라의 앨리스'** 에 나오는 **'모조 거북'** 이야기에서 나오는... 앨리스 **빅팬** 의 덕심인 듯 합니다~... ㅉㅉㅉ.. <strike>이 싸이트 주인장도.. ㅈㅁㅁ</strike>

어쨌든, 여차저차 해서, 보건환경 연구소의 이틀치 공기질 데이터를 스크래핑으로 긁어와서 분석해 보는 것이 본 포스트의 주제가 되겠습니다. 간단한 스크래핑 스크립트를 만들어 Pandas 로 분석하기 위해, 데이터형식을 맞춰주고, DataFrame 포맷으로 변경해 줍니다.

>
| <img src="/images/post_img/20180927-03scripts.png" width="600"> |
|:----------------------------------------------|
| **Fig.01** - 최종적으로 스크레핑한 데이터값을 DF형식으로 저장 |

이런 식입니다, 일단 DataFrame 포맷으로 변경하면, 씹고-뜯고-즐기고-맛보고 할수 있는 포맷으로 변경이 완료되었습니다. 데이터 분석의 전처리가 완료 되었습니다.


<br><br>
# 2.0 미세먼지 변동량 분석 (PM2.5 / PM10)

>
| <img src="/images/post_img/20180927-01pms.png" width="400"> |
|:----------------------------------------------|
| **Fig.02** - 이틀치 미세먼지 PM2.5, PM10 플로팅 |

전체적으로 이틀간의 데이터는 점차적으로 공기질이 좋아지는 족으로 경향을 보이고 있습니다. 특이점이 있는지 살펴보이... 출근전 시간대 새벽3시 부터 미세먼지량이 증가하기 시작하다가, 출근시간대인 9시에 Peak치를 형성 합니다. <strike>남동공단아.. 출근시간대 미세먼지 대량 방출?! </strike>

미세먼지는 연소에서 대량발생합니다. 특히 자동차 매연, 디젤엔진 연소 등이 주된 원인으로 지목되고 있습니다.


<br><br>
# 3.0 다른 특이점 (아황산가스, 이산화질소)

아황산 가스와 이산화 질소의 '이틀치' 변동량을 보면, 역시(!) <strike>잡았다! 요놈!</strike> 출근시간대인 9시에 피크치를 보이고 있지만, 데일리 변화가 아니라, 특이하게 올라간 경향을 보입니다. 원인분석이 필요할 것 같습니다.

>
| <img src="/images/post_img/20180927-02chemicals.png" width="400"> |
|:----------------------------------------------|
| **Fig.03** - 아황산가스, 이산화질소 변동 추이 |

그밖에도 이산화탄소, 오존농도 등이 있지만.. 특이점 변동사항이 없이 너무 평범해서, 따로 포스팅 하지 않습니다. <strike>아~.. 귀챦...</strike>

<br><br>
# 4.0 뒷 썰

이상으로 간단한 웹스크레핑으로 이틀치 공기질 분석후 특이점을 발견해 보았습니다. 웹싸이트 상으로 특정기간 동안의 데이터는 제공하는 것 같아 보이지 않습니다. <strike>요청하면 줄지는 안해봐서 모를..</strike> 웹스크래핑으로 48시간 마다 데이터를 긁어와도, 서버에 큰 부담없이 분석가능한 데이터를 축적할 수 있을 듯 합니다.

**별도의 API 가 있는지는 모릅니다.** <strike>나도 안해봐서 모름...</strike>

각종 공기질 상태를 보여주는 앱은 많은데, 추세를 보여주는 것은 없.. <strike>있나?...</strike> 책임질 말은 잘 안하는 관계로

**급히 마침니다~..**
